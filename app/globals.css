@tailwind base;
@tailwind components;
@tailwind utilities;

@import url('https://fonts.googleapis.com/css2?family=Press+Start+2P&family=VT323&display=swap');

@layer base {
  body {
    @apply bg-retro-beige-100 text-gray-900 font-mono;
    cursor: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16"><rect width="16" height="16" fill="white" stroke="black"/></svg>'), auto;
  }
}

@layer components {
  /* Retro button styles */
  .retro-button {
    @apply px-3 py-2 bg-retro-beige-200 border-2 border-solid;
    border-color: #fff #000 #000 #fff;
    box-shadow: inset 1px 1px 0 0 rgba(255,255,255,0.8);
    font-size: 12px;
    text-align: center;
    cursor: pointer;
    user-select: none;
  }

  .retro-button:hover {
    @apply bg-retro-beige-300;
  }

  .retro-button:active {
    border-color: #000 #fff #fff #000;
    box-shadow: inset 1px 1px 2px 0 rgba(0,0,0,0.3);
  }

  .retro-button:focus-visible {
    @apply outline outline-2 outline-offset-2 outline-blue-600;
  }

  /* Window chrome */
  .window-chrome {
    @apply border-2 border-solid bg-retro-beige-200;
    border-color: #fff #000 #000 #fff;
    box-shadow: 2px 2px 0 0 rgba(0,0,0,0.3);
  }

  .window-title-bar {
    @apply bg-gradient-to-r from-blue-700 to-blue-500 text-white px-1 py-1 flex items-center justify-between;
    font-size: 13px;
  }

  .window-title-bar-inactive {
    @apply bg-gradient-to-r from-gray-600 to-gray-400;
  }

  /* Pixel-perfect borders */
  .pixel-border {
    border-style: solid;
    border-width: 1px;
    image-rendering: pixelated;
  }

  /* Desktop icon */
  .desktop-icon {
    @apply flex flex-col items-center gap-1 p-2 rounded cursor-pointer select-none;
    @apply hover:bg-blue-500/20 focus:bg-blue-500/30 focus:outline focus:outline-2 focus:outline-blue-600;
    @apply active:bg-blue-500/40;
  }

  /* CRT screen effects */
  .crt-effect {
    position: relative;
    overflow: hidden;
  }

  .crt-effect::before {
    content: '';
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    background: repeating-linear-gradient(
      0deg,
      rgba(0, 0, 0, 0.15),
      rgba(0, 0, 0, 0.15) 1px,
      transparent 1px,
      transparent 2px
    );
    pointer-events: none;
    z-index: 9999;
    animation: scan 8s linear infinite;
  }

  .crt-effect::after {
    content: '';
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    background: radial-gradient(ellipse at center, transparent 0%, rgba(0,0,0,0.3) 100%);
    pointer-events: none;
    z-index: 9998;
  }

  /* Chromatic aberration */
  .chromatic-aberration {
    position: relative;
  }

  .chromatic-aberration::before {
    content: attr(data-text);
    position: absolute;
    left: -1px;
    text-shadow: -1px 0 red;
    top: 0;
    color: transparent;
    background: transparent;
    overflow: hidden;
    clip: rect(0, 900px, 0, 0);
    animation: glitch-1 2s infinite linear alternate-reverse;
  }

  /* Dithering texture */
  .dither-texture {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAIAAAACCAYAAABytg0kAAAAFElEQVQIW2NkYGD4z8DAwMgABQAADgABfaXVhQAAAABJRU5ErkJggg==');
    background-repeat: repeat;
  }
}

@layer utilities {
  /* Hide scrollbar but keep functionality */
  .scrollbar-hide::-webkit-scrollbar {
    display: none;
  }
  .scrollbar-hide {
    -ms-overflow-style: none;
    scrollbar-width: none;
  }

  /* Retro scrollbar */
  .scrollbar-retro::-webkit-scrollbar {
    width: 16px;
    height: 16px;
  }

  .scrollbar-retro::-webkit-scrollbar-track {
    background: #d4d0c8;
    border: 1px solid #808080;
  }

  .scrollbar-retro::-webkit-scrollbar-thumb {
    background: #c0c0c0;
    border: 2px solid;
    border-color: #ffffff #000000 #000000 #ffffff;
  }

  .scrollbar-retro::-webkit-scrollbar-thumb:hover {
    background: #b0b0b0;
  }

  .scrollbar-retro::-webkit-scrollbar-corner {
    background: #d4d0c8;
  }

  /* Text selection */
  ::selection {
    background: #000080;
    color: #ffffff;
  }
}

/* Theme variants */
[data-theme="classic-beige"] {
  --color-bg: #c0c0c0;
  --color-surface: #d4d0c8;
  --color-border: #808080;
}

[data-theme="olive-gray"] {
  --color-bg: #3a3a3a;
  --color-surface: #4a4a4a;
  --color-border: #2a2a2a;
}

[data-theme="olive-gray"] body {
  @apply bg-retro-olive-800 text-retro-olive-100;
}

[data-theme="candy-blue"] {
  --color-bg: #5f9ed1;
  --color-surface: #7db9e8;
  --color-border: #3a7ca5;
}

[data-theme="candy-blue"] body {
  @apply bg-blue-300 text-blue-900;
}

/* Animations */
@keyframes scan {
  0% {
    transform: translateY(-100%);
  }
  100% {
    transform: translateY(100%);
  }
}

@keyframes glitch-1 {
  0% {
    clip: rect(42px, 9999px, 44px, 0);
  }
  5% {
    clip: rect(12px, 9999px, 59px, 0);
  }
  10% {
    clip: rect(48px, 9999px, 29px, 0);
  }
  15% {
    clip: rect(42px, 9999px, 73px, 0);
  }
  20% {
    clip: rect(63px, 9999px, 27px, 0);
  }
  25% {
    clip: rect(34px, 9999px, 55px, 0);
  }
  30% {
    clip: rect(86px, 9999px, 73px, 0);
  }
  35% {
    clip: rect(20px, 9999px, 20px, 0);
  }
  40% {
    clip: rect(26px, 9999px, 60px, 0);
  }
  45% {
    clip: rect(25px, 9999px, 66px, 0);
  }
  50% {
    clip: rect(57px, 9999px, 98px, 0);
  }
  55% {
    clip: rect(5px, 9999px, 46px, 0);
  }
  60% {
    clip: rect(82px, 9999px, 31px, 0);
  }
  65% {
    clip: rect(54px, 9999px, 27px, 0);
  }
  70% {
    clip: rect(28px, 9999px, 99px, 0);
  }
  75% {
    clip: rect(45px, 9999px, 69px, 0);
  }
  80% {
    clip: rect(23px, 9999px, 85px, 0);
  }
  85% {
    clip: rect(54px, 9999px, 84px, 0);
  }
  90% {
    clip: rect(45px, 9999px, 47px, 0);
  }
  95% {
    clip: rect(37px, 9999px, 20px, 0);
  }
  100% {
    clip: rect(4px, 9999px, 91px, 0);
  }
}

/* Focus visible for accessibility */
*:focus-visible {
  @apply outline outline-2 outline-offset-2 outline-blue-600;
}

/* Reduced motion */
@media (prefers-reduced-motion: reduce) {
  *,
  *::before,
  *::after {
    animation-duration: 0.01ms !important;
    animation-iteration-count: 1 !important;
    transition-duration: 0.01ms !important;
  }
}
